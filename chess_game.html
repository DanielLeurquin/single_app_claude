<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chess Game</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .square { aspect-ratio: 1; }
    .light { background: #f0d9b5; }
    .dark { background: #b58863; }
    .selected { box-shadow: inset 0 0 0 3px #7c3; }
    .valid-move { background: radial-gradient(circle, rgba(0,255,0,0.3) 25%, transparent 25%); }
    .piece { cursor: pointer; user-select: none; width: 80%; height: 80%; }
  </style>
</head>
<body class="bg-gray-900 text-white min-h-screen flex items-center justify-center p-4">
  <div class="max-w-2xl w-full">
    <div class="bg-gray-800 rounded-lg p-6 shadow-2xl">
      <div class="flex justify-between items-center mb-4">
        <h1 class="text-3xl font-bold">Chess</h1>
        <div class="text-right">
          <div class="text-lg font-semibold" id="turn">White's Turn</div>
          <button onclick="resetGame()" class="mt-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded text-sm">New Game</button>
        </div>
      </div>
      <div id="board" class="grid grid-cols-8 gap-0 w-full max-w-xl mx-auto border-4 border-gray-700"></div>
      <div id="status" class="mt-4 text-center text-lg font-semibold"></div>
    </div>
  </div>

  <script>
    const pieces = {
      '♔': 'K', '♕': 'Q', '♖': 'R', '♗': 'B', '♘': 'N', '♙': 'P',
      '♚': 'k', '♛': 'q', '♜': 'r', '♝': 'b', '♞': 'n', '♟': 'p'
    };

    const pieceImages = {
      '♔': 'https://upload.wikimedia.org/wikipedia/commons/4/42/Chess_klt45.svg',
      '♕': 'https://upload.wikimedia.org/wikipedia/commons/1/15/Chess_qlt45.svg',
      '♖': 'https://upload.wikimedia.org/wikipedia/commons/7/72/Chess_rlt45.svg',
      '♗': 'https://upload.wikimedia.org/wikipedia/commons/b/b1/Chess_blt45.svg',
      '♘': 'https://upload.wikimedia.org/wikipedia/commons/7/70/Chess_nlt45.svg',
      '♙': 'https://upload.wikimedia.org/wikipedia/commons/4/45/Chess_plt45.svg',
      '♚': 'https://upload.wikimedia.org/wikipedia/commons/f/f0/Chess_kdt45.svg',
      '♛': 'https://upload.wikimedia.org/wikipedia/commons/4/47/Chess_qdt45.svg',
      '♜': 'https://upload.wikimedia.org/wikipedia/commons/f/ff/Chess_rdt45.svg',
      '♝': 'https://upload.wikimedia.org/wikipedia/commons/9/98/Chess_bdt45.svg',
      '♞': 'https://upload.wikimedia.org/wikipedia/commons/e/ef/Chess_ndt45.svg',
      '♟': 'https://upload.wikimedia.org/wikipedia/commons/c/c7/Chess_pdt45.svg'
    };

    let board = [
      ['♜','♞','♝','♛','♚','♝','♞','♜'],
      ['♟','♟','♟','♟','♟','♟','♟','♟'],
      ['','','','','','','',''],
      ['','','','','','','',''],
      ['','','','','','','',''],
      ['','','','','','','',''],
      ['♙','♙','♙','♙','♙','♙','♙','♙'],
      ['♖','♘','♗','♕','♔','♗','♘','♖']
    ];

    let selected = null;
    let currentTurn = 'white';
    let validMoves = [];

    function initBoard() {
      const boardEl = document.getElementById('board');
      boardEl.innerHTML = '';
      for (let r = 0; r < 8; r++) {
        for (let c = 0; c < 8; c++) {
          const sq = document.createElement('div');
          sq.className = `square flex items-center justify-center ${(r + c) % 2 === 0 ? 'light' : 'dark'}`;
          sq.dataset.row = r;
          sq.dataset.col = c;
          sq.onclick = () => handleClick(r, c);
          
          if (board[r][c]) {
            const piece = document.createElement('img');
            piece.className = 'piece';
            piece.src = pieceImages[board[r][c]];
            piece.alt = board[r][c];
            sq.appendChild(piece);
          }
          boardEl.appendChild(sq);
        }
      }
      updateTurn();
      clearHighlights();
    }

    function clearHighlights() {
      document.querySelectorAll('.square').forEach(sq => {
        sq.classList.remove('selected', 'valid-move');
      });
    }

    function handleClick(r, c) {
      const piece = board[r][c];
      
      if (selected) {
        if (validMoves.some(m => m[0] === r && m[1] === c)) {
          board[r][c] = board[selected[0]][selected[1]];
          board[selected[0]][selected[1]] = '';
          currentTurn = currentTurn === 'white' ? 'black' : 'white';
          selected = null;
          validMoves = [];
          initBoard();
          checkWin();
        } else if (piece && isCurrentPlayer(piece)) {
          selected = [r, c];
          validMoves = getValidMoves(r, c);
          highlightMoves();
        } else {
          selected = null;
          validMoves = [];
          initBoard();
        }
      } else if (piece && isCurrentPlayer(piece)) {
        selected = [r, c];
        validMoves = getValidMoves(r, c);
        highlightMoves();
      }
    }

    function isCurrentPlayer(piece) {
      return (currentTurn === 'white' && piece >= '♔' && piece <= '♙') ||
             (currentTurn === 'black' && piece >= '♚' && piece <= '♟');
    }

    function getValidMoves(r, c) {
      const piece = board[r][c];
      const type = pieces[piece];
      const moves = [];
      const isWhite = piece >= '♔' && piece <= '♙';

      if (type === 'P' || type === 'p') {
        const dir = isWhite ? -1 : 1;
        const startRow = isWhite ? 6 : 1;
        if (r + dir >= 0 && r + dir < 8 && !board[r + dir][c]) {
          moves.push([r + dir, c]);
          if (r === startRow && !board[r + 2 * dir][c]) moves.push([r + 2 * dir, c]);
        }
        [-1, 1].forEach(dc => {
          if (c + dc >= 0 && c + dc < 8 && board[r + dir]?.[c + dc] && 
              isOpponent(board[r + dir][c + dc], isWhite)) {
            moves.push([r + dir, c + dc]);
          }
        });
      } else if (type === 'N' || type === 'n') {
        [[-2,-1],[-2,1],[-1,-2],[-1,2],[1,-2],[1,2],[2,-1],[2,1]].forEach(([dr,dc]) => {
          const nr = r + dr, nc = c + dc;
          if (nr >= 0 && nr < 8 && nc >= 0 && nc < 8 && 
              (!board[nr][nc] || isOpponent(board[nr][nc], isWhite))) {
            moves.push([nr, nc]);
          }
        });
      } else if (type === 'B' || type === 'b') {
        addLineMoves(r, c, isWhite, moves, [[1,1],[1,-1],[-1,1],[-1,-1]]);
      } else if (type === 'R' || type === 'r') {
        addLineMoves(r, c, isWhite, moves, [[1,0],[-1,0],[0,1],[0,-1]]);
      } else if (type === 'Q' || type === 'q') {
        addLineMoves(r, c, isWhite, moves, [[1,0],[-1,0],[0,1],[0,-1],[1,1],[1,-1],[-1,1],[-1,-1]]);
      } else if (type === 'K' || type === 'k') {
        [[1,0],[-1,0],[0,1],[0,-1],[1,1],[1,-1],[-1,1],[-1,-1]].forEach(([dr,dc]) => {
          const nr = r + dr, nc = c + dc;
          if (nr >= 0 && nr < 8 && nc >= 0 && nc < 8 && 
              (!board[nr][nc] || isOpponent(board[nr][nc], isWhite))) {
            moves.push([nr, nc]);
          }
        });
      }
      return moves;
    }

    function addLineMoves(r, c, isWhite, moves, dirs) {
      dirs.forEach(([dr, dc]) => {
        let nr = r + dr, nc = c + dc;
        while (nr >= 0 && nr < 8 && nc >= 0 && nc < 8) {
          if (board[nr][nc]) {
            if (isOpponent(board[nr][nc], isWhite)) moves.push([nr, nc]);
            break;
          }
          moves.push([nr, nc]);
          nr += dr;
          nc += dc;
        }
      });
    }

    function isOpponent(piece, isWhite) {
      return isWhite ? (piece >= '♚' && piece <= '♟') : (piece >= '♔' && piece <= '♙');
    }

    function highlightMoves() {
      initBoard();
      if (selected) {
        const sq = document.querySelector(`[data-row="${selected[0]}"][data-col="${selected[1]}"]`);
        sq.classList.add('selected');
        validMoves.forEach(([r, c]) => {
          const sq = document.querySelector(`[data-row="${r}"][data-col="${c}"]`);
          sq.classList.add('valid-move');
        });
      }
    }

    function updateTurn() {
      document.getElementById('turn').textContent = currentTurn === 'white' ? "White's Turn" : "Black's Turn";
    }

    function checkWin() {
      let whiteKing = false, blackKing = false;
      for (let r = 0; r < 8; r++) {
        for (let c = 0; c < 8; c++) {
          if (board[r][c] === '♔') whiteKing = true;
          if (board[r][c] === '♚') blackKing = true;
        }
      }
      if (!whiteKing) {
        document.getElementById('status').textContent = '🎉 Black Wins!';
      } else if (!blackKing) {
        document.getElementById('status').textContent = '🎉 White Wins!';
      }
    }

    function resetGame() {
      board = [
        ['♜','♞','♝','♛','♚','♝','♞','♜'],
        ['♟','♟','♟','♟','♟','♟','♟','♟'],
        ['','','','','','','',''],
        ['','','','','','','',''],
        ['','','','','','','',''],
        ['','','','','','','',''],
        ['♙','♙','♙','♙','♙','♙','♙','♙'],
        ['♖','♘','♗','♕','♔','♗','♘','♖']
      ];
      selected = null;
      currentTurn = 'white';
      validMoves = [];
      document.getElementById('status').textContent = '';
      initBoard();
    }

    initBoard();
  </script>
</body>
</html>